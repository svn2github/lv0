/* $Id: servload.c 2030 2012-07-06 11:06:44Z umaxx $ */

/*
 * Copyright (c) 2012 Joerg Zinke <umaxx@lv0.org>
 *
 * Permission to use, copy, modify, and distribute this software for any purpose
 * with or without fee is hereby granted, provided that the above copyright 
 * notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
 * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
 * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
 * OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 * PERFORMANCE OF THIS SOFTWARE.
 */
void pixel(unsigned short, unsigned short, unsigned int);
void main(void);

static void character(unsigned short, unsigned short, unsigned int, unsigned char);
static void print(const char *);

static char font[] = {
    0x00, 0x00, 0x1E, 0x30, 0x3E, 0x33, 0x6E, 0x00, /* a */
    0x07, 0x06, 0x06, 0x3E, 0x66, 0x66, 0x3B, 0x00, /* b */
    0x00, 0x00, 0x1E, 0x33, 0x03, 0x33, 0x1E, 0x00, /* c */
    0x38, 0x30, 0x30, 0x3e, 0x33, 0x33, 0x6E, 0x00, /* d */
    0x00, 0x00, 0x1E, 0x33, 0x3f, 0x03, 0x1E, 0x00, /* e */
    0x1C, 0x36, 0x06, 0x0f, 0x06, 0x06, 0x0F, 0x00, /* f */
    0x00, 0x00, 0x6E, 0x33, 0x33, 0x3E, 0x30, 0x1F, /* g */
    0x07, 0x06, 0x36, 0x6E, 0x66, 0x66, 0x67, 0x00, /* h */
    0x0C, 0x00, 0x0E, 0x0C, 0x0C, 0x0C, 0x1E, 0x00, /* i */
    0x30, 0x00, 0x30, 0x30, 0x30, 0x33, 0x33, 0x1E, /* j */
    0x07, 0x06, 0x66, 0x36, 0x1E, 0x36, 0x67, 0x00, /* k */
    0x0E, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x1E, 0x00, /* l */
    0x00, 0x00, 0x33, 0x7F, 0x7F, 0x6B, 0x63, 0x00, /* m */
    0x00, 0x00, 0x1F, 0x33, 0x33, 0x33, 0x33, 0x00, /* n */
    0x00, 0x00, 0x1E, 0x33, 0x33, 0x33, 0x1E, 0x00, /* o */
    0x00, 0x00, 0x3B, 0x66, 0x66, 0x3E, 0x06, 0x0F, /* p */
    0x00, 0x00, 0x6E, 0x33, 0x33, 0x3E, 0x30, 0x78, /* q */
    0x00, 0x00, 0x3B, 0x6E, 0x66, 0x06, 0x0F, 0x00, /* r */
    0x00, 0x00, 0x3E, 0x03, 0x1E, 0x30, 0x1F, 0x00, /* s */
    0x08, 0x0C, 0x3E, 0x0C, 0x0C, 0x2C, 0x18, 0x00, /* t */
    0x00, 0x00, 0x33, 0x33, 0x33, 0x33, 0x6E, 0x00, /* u */
    0x00, 0x00, 0x33, 0x33, 0x33, 0x1E, 0x0C, 0x00, /* v */
    0x00, 0x00, 0x63, 0x6B, 0x7F, 0x7F, 0x36, 0x00, /* w */
    0x00, 0x00, 0x63, 0x36, 0x1C, 0x36, 0x63, 0x00, /* x */
    0x00, 0x00, 0x33, 0x33, 0x33, 0x3E, 0x30, 0x1F, /* y */
    0x00, 0x00, 0x3F, 0x19, 0x0C, 0x26, 0x3F, 0x00, /* z */
};

/* add line(x1, y1, x2, y2, color) */

static void
character(unsigned short x, unsigned short y, unsigned int color, unsigned char value) {
    unsigned short i, j;

    for (i = 0; i < 8; i++)
        for (j = 0; j < 8; j++)
            if (font[((value - 97) * 8) + i] & (1 << j)) /* 97 is ascii offset a */
                pixel(x + j, y + i, color);
}

static void
print(const char *string) {
    unsigned short x = 50;

    while (*string != '\0')
        character(x+=8, 50, 0xc0c0c0, *string++);
}

void 
main(void) {
    unsigned short x, y, c=0;

    pixel(5, 5, 0xff0000);
    pixel(10, 10, 0x0000ff);
    print("helloworld");
    for (y = 100; y < 500; y++, c++)
        for (x = 100; x < 700; x++)
            pixel(x, y, c);
}
